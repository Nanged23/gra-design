{"ast":null,"code":"import \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport \"core-js/modules/esnext.iterator.some.js\";\nimport Cookies from 'js-cookie';\nexport default {\n  mounted() {\n    Cookies.set('skey', 'cMsL2qYX', {\n      expires: 7\n    });\n    Cookies.set('vid', '442726869', {\n      expires: 7\n    });\n  },\n  data() {\n    return {\n      data: {\n        books: [],\n        archive: [],\n        archive: null\n      },\n      archive: null\n    };\n  },\n  computed: {},\n  methods: {\n    getGridPositionClass(index) {\n      // 根据索引返回对应的区域类名\n      const positions = ['top-left', 'top-right', 'bottom-left', 'bottom-right'];\n      return positions[index % 4]; // 循环分配\n    },\n    get_message() {\n      this.$store.dispatch('loading/startLoading');\n      let url = \"http://127.0.0.1:5000/weread/info\";\n      axios({\n        method: 'POST',\n        url: url,\n        // 这里的`url`需要确保已经在合适的作用域内有定义\n        withCredentials: true // 对应fetch里的`credentials: 'include'`，用于跨域等场景下携带凭证\n      }).then(response => {\n        const jsonData = response.data; // axios会自动解析JSON数据，直接取`response.data`即可\n        this.data = jsonData;\n        console.log('Full Data:', jsonData); // Log full data\n        console.log('archive:', jsonData.archive); // Log archive data\n        console.log('Books:', jsonData.books); // Log books\n        console.log('Archive:', jsonData.archive); // Log archive\n\n        this.archive = jsonData.archive;\n        this.$nextTick(() => {\n          const archivesInBooks = this.booksNotInarchives();\n          const booksInarchive = this.getBooksInarchive(this.archive?.bookIds);\n          console.log('Books in archive:', booksInarchive);\n        });\n      }).catch(error => {\n        console.error(\"获取用户信息时出现 bug \" + error);\n      }).then(() => {\n        this.$store.dispatch('loading/stopLoading');\n      });\n    },\n    // 获取某个文件夹中包含的书籍\n    getBooksInarchive(bookIds) {\n      if (!bookIds || !this.data?.books) return [];\n      return this.data.books.filter(book => bookIds.includes(book.bookId));\n    },\n    booksNotInarchives() {\n      if (!this.data?.books || !this.data?.archive) return [];\n      return this.data.books.filter(book => !this.data.archive.some(archive => archive.bookIds.includes(book.bookId)));\n    },\n    truncatedTitle(title) {\n      if (title.length > 15) title = title.substring(0, 15) + '...';\n      return title;\n    }\n  }\n};","map":{"version":3,"names":["Cookies","mounted","set","expires","data","books","archive","computed","methods","getGridPositionClass","index","positions","get_message","$store","dispatch","url","axios","method","withCredentials","then","response","jsonData","console","log","$nextTick","archivesInBooks","booksNotInarchives","booksInarchive","getBooksInarchive","bookIds","catch","error","filter","book","includes","bookId","some","truncatedTitle","title","length","substring"],"sources":["/Users/dongliwei/Desktop/文档/CQUPT 课程/毕业设计/Front-end/front-end/src/components/third-content/third_weread.vue"],"sourcesContent":["<style scoped>\n.all {\n    margin-left: 250px;\n}\n\n.archive-grid {\n    width: 100%;\n}\n\n.grid-container {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    grid-template-rows: 1fr 1fr;\n    gap: 10px;\n    height: 300px;\n    /* Adjust as needed */\n    width: 100%;\n}\n\n.grid-item {\n    overflow: hidden;\n}\n\n.book-cover {\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n}\n\n/* Optional: Add specific positioning if needed */\n.grid-item-1 {\n    grid-area: 1 / 1 / 2 / 2;\n}\n\n/* Top Left */\n.grid-item-2 {\n    grid-area: 1 / 2 / 2 / 3;\n}\n\n/* Top Right */\n.grid-item-3 {\n    grid-area: 2 / 1 / 3 / 2;\n}\n\n/* Bottom Left */\n.grid-item-4 {\n    grid-area: 2 / 2 / 3 / 3;\n}\n\n/* Bottom Right */\n.archive-container {\n    padding: 16px;\n}\n\n.thumbnail-grid {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    /* 两列布局 */\n    grid-template-rows: 1fr 1fr;\n    /* 两行布局 */\n    gap: 8px;\n    /* 图片之间的间距 */\n    width: 200px;\n    /* 缩略图的总宽度 */\n    height: 200px;\n    /* 缩略图的总高度 */\n    position: relative;\n    overflow: hidden;\n}\n\n.grid-item {\n    width: 100%;\n    height: 100%;\n    position: relative;\n}\n\n.grid-item img {\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n}\n\n.grid-item.top-left {\n    grid-area: 1 / 1;\n    /* 第一行第一列 */\n}\n\n.grid-item.top-right {\n    grid-area: 1 / 2;\n    /* 第一行第二列 */\n}\n\n.grid-item.bottom-left {\n    grid-area: 2 / 1;\n    /* 第二行第一列 */\n}\n\n.grid-item.bottom-right {\n    grid-area: 2 / 2;\n    /* 第二行第二列 */\n}\n\n.book-grid {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 16px;\n    /* 卡片之间的间距 */\n    justify-content: flex-start;\n    /* 从左侧开始排列 */\n}\n\n.card {\n    box-sizing: border-box;\n    width: calc((100% - 4 * 16px) / 5);\n    /* 计算每个卡片的宽度，减去间距 */\n    backdrop-filter: blur(6px);\n    justify-content: center;\n    border-radius: 17px;\n    text-align: center;\n    cursor: pointer;\n    transition: all 0.5s;\n    margin-bottom: 16px;\n    /* 垂直方向的间距 */\n}\n\n.card-content {\n    justify-content: center;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    width: 100%;\n}\n\n.card-image {\n    border-radius: 17px;\n    object-fit: cover;\n    width: 128px;\n    height: 185px;\n    /* 可以根据需要调整 */\n}\n\n.card-title {\n    justify-content: center;\n    margin-top: 8px;\n    width: 100%;\n    word-wrap: break-word;\n    text-align: center;\n    padding: 0 5px;\n    height: 60px;\n}\n\n.card:hover {\n\n    transform: scale(1.05);\n}\n</style>\n<template>\n    <div class=\"all\">\n        <button @click=\"get_message()\">\n            获取\n        </button>\n\n        <!-- 渲染文件 -->\n        <div class=\"book-grid\">\n            <div v-for=\"book in booksNotInarchives()\" :key=\"book.bookId\" class=\"card\">\n                <div class=\"card-content\">\n                    <img :src=\"book.cover\" class=\"card-image\">\n                    <div class=\"card-title\">{{ truncatedTitle(book.title) }}</div>\n                </div>\n            </div>\n        </div>\n\n        <!-- 渲染文件夹 -->\n        <div class=\"archive-grid\" v-if=\"archive && getBooksInarchive(archive.bookIds).length > 0\">\n            <div class=\"grid-container\">\n                <div v-for=\"(book, index) in getBooksInarchive(archive.bookIds).slice(0, 4)\" :key=\"book.bookId\"\n                    :class=\"`grid-item grid-item-${index + 1}`\">\n                    <img :src=\"book.cover\" :alt=\"book.title\" class=\"book-cover\" />\n                </div>\n            </div>\n            <h3>{{ archive.name }}</h3>\n            <hr>\n        </div>\n    </div>\n</template>\n\n<script>\nimport Cookies from 'js-cookie';\nexport default {\n    mounted() {\n        Cookies.set('skey', 'cMsL2qYX', { expires: 7 });\n        Cookies.set('vid', '442726869', { expires: 7 });\n    },\n    data() {\n        return {\n            data: {\n                books: [],\n                archive: [],\n                archive: null\n            },\n            archive: null\n        }\n    },\n    computed: {},\n    methods: {\n        getGridPositionClass(index) {\n            // 根据索引返回对应的区域类名\n            const positions = ['top-left', 'top-right', 'bottom-left', 'bottom-right'];\n            return positions[index % 4]; // 循环分配\n        },\n        get_message() {\n            this.$store.dispatch('loading/startLoading');\n            let url = \"http://127.0.0.1:5000/weread/info\"\n            axios({\n                method: 'POST',\n                url: url, // 这里的`url`需要确保已经在合适的作用域内有定义\n                withCredentials: true // 对应fetch里的`credentials: 'include'`，用于跨域等场景下携带凭证\n            })\n                .then(response => {\n                    const jsonData = response.data; // axios会自动解析JSON数据，直接取`response.data`即可\n                    this.data = jsonData;\n                    console.log('Full Data:', jsonData); // Log full data\n                    console.log('archive:', jsonData.archive); // Log archive data\n                    console.log('Books:', jsonData.books); // Log books\n                    console.log('Archive:', jsonData.archive); // Log archive\n\n                    this.archive = jsonData.archive;\n                    this.$nextTick(() => {\n                        const archivesInBooks = this.booksNotInarchives();\n                        const booksInarchive = this.getBooksInarchive(this.archive?.bookIds);\n                        console.log('Books in archive:', booksInarchive);\n                    });\n                })\n                .catch(error => {\n                    console.error(\"获取用户信息时出现 bug \" + error);\n                })\n                .then(() => {\n                    this.$store.dispatch('loading/stopLoading');\n                });},\n            // 获取某个文件夹中包含的书籍\n            getBooksInarchive(bookIds) {\n                if (!bookIds || !this.data?.books) return [];\n                return this.data.books.filter(book =>\n                    bookIds.includes(book.bookId)\n                );\n            },\n            booksNotInarchives() {\n                if (!this.data?.books || !this.data?.archive) return [];\n                return this.data.books.filter(book =>\n                    !this.data.archive.some(archive =>\n                        archive.bookIds.includes(book.bookId)\n                    )\n                );\n            },\n            truncatedTitle(title) {\n                if (title.length > 15) title = title.substring(0, 15) + '...'\n                return title;\n            }\n        },\n    };\n</script>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}